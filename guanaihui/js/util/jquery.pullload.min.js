!function(t){t.fn.pullload=function(a){var e=t.extend({},t.fn.pullload.defaults,a),l=!1;return this.each(function(){var a=this;t(window).scroll(function(){var o=t(window).height(),d=t(window).scrollTop(),n=t(a).find(e.childElementSelector).last(),s=n.height()+n.offset().top+e.threshold;o+d>s&&(l?l=!1:(t.fn.pullload.request(a,e),l=!0))})})},t.fn.pullload.request=function(a,e){var l,o=e.crossDomain?"jsonp":"json",d=e.crossDomain?"GET":e.requestType,n={};void 0!=t(a).attr(e.reuqestDataAttr)&&""!=t(a).attr(e.reuqestDataAttr)&&(n=t.parseJSON(t(a).attr(e.reuqestDataAttr))),void 0==t(a).attr(e.loadedPageCountAttr)?(l=2,t(a).attr(e.loadedPageCountAttr,l)):l=t(a).attr(e.loadedPageCountAttr),n[e.requestPageKey]=l,t.fn.pullload.tips(e.loadingTips,a,e);try{t.ajax({url:e.apiUrl,type:d,dataType:o,data:n,success:function(l){e.callBack&&e.callBack(l);var o=""==t(a).attr(e.loadedPageCountAttr)||void 0==t(a).attr(e.loadedPageCountAttr)?0:parseInt(t(a).attr(e.loadedPageCountAttr),10);t(a).attr(e.loadedPageCountAttr,o+1),l[e.countKey]?l[e.countKey]===t(a).find(e.childElementSelector).size()&&(t.fn.pullload.tips(e.lastLoadedTips,a,e),t(window).off("scroll")):t.fn.pullload.closeTips(a,e)},error:function(){t.fn.pullload.tips(e.loadFailedTips,a,e)}})}catch(s){t.fn.pullload.tips("错误名称："+s.name+"\n错误描述："+s.message)}},t.fn.pullload.tips=function(a,e,l){var o=t(e).next("."+l.tipsClassName);0===o.size()?(t(e).after("<div id='dataLoadStatus' class=\""+l.tipsClassName+'"></div>'),t(e).next("."+l.tipsClassName).html(a),t(e).fadeIn(100)):(o.html()!==a&&o.html(a),o.fadeIn(100))},t.fn.pullload.closeTips=function(a,e){t(a).next("."+e.tipsClassName).fadeOut(100)},t.fn.pullload.defaults={handler:window,direction:"up",apiUrl:"",crossDoman:!1,requestType:"GET",callBack:null,loadedPageCountAttr:"data-loadedPageCount",requestPageKey:"loadedPageCount",countKey:"count",tipsClassName:"portal",loadingTips:"数据加载中...",lastLoadedTips:"已经加载到最后一页！",loadFailedTips:"数据加载失败，请重试！",childElementSelector:"",reuqestDataAttr:"data-requestData",threshold:100}}(jQuery);