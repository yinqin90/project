function Controller(){this.environment="production",this.staticDomain="//cdn01.360guanai.com",this.utilStaticPrefix=this.staticDomain+"/guanaihui/js/util",this.appStaticPrefix=this.staticDomain+"/apps/enterprise.360guanai.com/js",this.cookieDomain=".360guanai.com",this.cookieKeyPrefix="EC_",this.cookieKeyConf={userName:this.cookieKeyPrefix+"userName",userId:this.cookieKeyPrefix+"userId",companyName:this.cookieKeyPrefix+"companyName",orderAmount:this.cookieKeyPrefix+"orderAmount",contact:this.cookieKeyPrefix+"contact",tel:this.cookieKeyPrefix+"tel",address:this.cookieKeyPrefix+"address",description:this.cookieKeyPrefix+"description"},this.tipsDialogId="guanaihui-tips",this.confirmDialogId="guanaihui-confirm",this.apiDataType="test"===this.environment?"jsonp":"json",this.apiPrefix="test"===this.environment?"//test.360guanai.com/EnterpriseCenter":"/EnterpriseCenter",this.loginApiUrl=this.apiPrefix+"/EnterpriseUserLogin",this.logoutApiUrl=this.apiPrefix+"/EnterpriseUserLogout",this.orderListApiUrl=this.apiPrefix+"/GetOrderList",this.orderDetailApiUrl=this.apiPrefix+"/GetOrderDetail",this.resetPasswordApiUrl=this.apiPrefix+"/ResetPassword",this.updateProfileApiUrl=this.apiPrefix+"/UpdateEnterpriseUserInfo",this.lastOrderChartApiUrl=this.apiPrefix+"/GetEnterpriseReport",this.cardUseStatusApiUrl=this.apiPrefix+"/GetCardsByOrderId",this.pageSuffix="test"===this.environment?".html":"",this.welcomeUrl="console"+this.pageSuffix,this.logoutRedirectUrl="login"+this.pageSuffix,this.toperPageUrl="toper"+this.pageSuffix,this.lSidePageUrl="lSide"+this.pageSuffix,this.randomDomainSn=function(){var i=parseInt(20*Math.random()+1,10).toString();return i.length<2&&(i="0"+i),i},this.createModalDialog=function(i){var e=null===i||null===i.type||void 0===i.type?"dialog":i.type,t=i.id;"tips"===e?t=this.tipsDialogId:"confirm"===e&&(t=this.confirmDialogId);var o=null===i||null===i.tabindex||void 0===i.tabindex?null:i.tabindex,a=$(document.createElement("DIV")).attr("id",t).attr("role","dialog").attr("aria-labelledby","myModalLabel").addClass("modal fade");o&&$(a).attr("tabindex",o);var n=$(document.createElement("DIV")).attr("role","document").addClass("modal-dialog").append($(document.createElement("DIV")).addClass("modal-content"));$(a).append(n),$("body").prepend(a)},this.dialog=function(i){var e=null===i||null===i.tabindex||void 0===i.tabindex?null:i.tabindex;$("#"+i.id).size()>0&&$("#"+i.id).remove(),this.createModalDialog({type:"dialog",id:i.id,tabindex:e}),$("#"+i.id).modal({remote:i.url}),$.fn.modal.Constructor.prototype.enforceFocus=function(){}},this.tips=function(i,e,t){var o=this;$("#"+this.tipsDialogId).size()>0?($("#"+this.tipsDialogId+" .modal-tips").html(i),$("#"+this.tipsDialogId).modal("show")):(this.createModalDialog({type:"tips"}),$("#"+this.tipsDialogId).addClass("bs-example-modal-sm"),$("#"+this.tipsDialogId+" .modal-dialog").addClass("modal-sm"),$("#"+this.tipsDialogId+" .modal-content").append($(document.createElement("DIV")).addClass("modal-tips").html(i)),$("#"+this.tipsDialogId).modal({keyboard:!0})),e&&window.setTimeout(function(){$("#"+o.tipsDialogId).modal("hide"),t&&t()},1e3*e)},this.confirm=function(i){var e=this,t=null===i||null===i.title||void 0===i.title?"系统确认":i.title,o=null===i||null===i.content||void 0===i.content?"":i.content,a=null===i||null===i.confirmLabel||void 0===i.confirmLabel?"确认":i.confirmLabel,n=null===i||null===i.cancelLabel||void 0===i.cancelLabel?"取消":i.cancelLabel,s=null===i||null===i.confirmInterface||void 0===i.confirmInterface?null:i.confirmInterface,l=null===i||null===i.cancelInterface||void 0===i.cancelInterface?null:i.cancelInterface;$("#"+this.confirmDialogId).size()>0&&$("#"+this.confirmDialogId).remove(),this.createModalDialog({type:"confirm"}),$("#"+this.confirmDialogId+" .modal-content").append($(document.createElement("DIV")).addClass("modal-header").append('<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+t+"</h4>")),$("#"+this.confirmDialogId+" .modal-content").append($(document.createElement("DIV")).addClass("modal-confirm").html(o));var r=$(document.createElement("DIV")).addClass("modal-footer"),d=$(document.createElement("BUTTON")).attr("type","button").addClass("btn btn-primary").text(a);$(d).click(function(){s&&s(),$("#"+e.confirmDialogId).modal("hide")}),$(r).append(d);var c=$(document.createElement("BUTTON")).attr("type","button").addClass("btn btn-default").attr("data-dismiss","modal").text(n);$(c).click(function(){l&&l()}),$(r).append(c),$("#"+this.confirmDialogId+" .modal-content").append(r),$("#"+this.confirmDialogId).modal({keyboard:!0})},this.methodizeTable=function(){0!==$(".table-methodize").size()&&require([this.utilStaticPrefix+"/jquery.methodizetable.min.js"],function(){$(".table-methodize").methodizetable()})},this.request=function(i,e,t){var o=this,a=null===t||null===t.type||void 0===t.type?"GET":t.type,n=null===t||null===t.process||void 0===t.process?null:t.process,s=null===t||null===t.apiDataType||void 0===t.apiDataType?this.apiDataType:t.apiDataType,l=null===t||null===t.onExceptionInterface||void 0===t.onExceptionInterface?null:t.onExceptionInterface;this.tips("正在加载数据，请稍等...");try{$.ajax({url:i,type:a,data:e,dataType:s,error:function(){o.tips("调用数据接口失败！请测试您的数据接口！",3)},success:function(i){$("#"+o.tipsDialogId).modal("hide"),"301"===i.code.toString()?o.clearCookieRedirect():"200"===i.code.toString()?n&&n(i):(o.tips(i.message,3),l&&l(i.code,i.message))}})}catch(r){o.tips("错误名称："+r.name+"\n错误描述："+r.message,3)}},this.loadPortals=function(i){if(0!==$("#toper").size()&&0!==$("#lSide").size()){var e=this;$("#lSide").load(this.lSidePageUrl,function(){$("#lSide .order-amount").text($.cookie(e.cookieKeyConf.orderAmount)),e.bindLocationToLSide(i),e.addListenerToSearcher(),e.switchBranch(),$("#toper").load(e.toperPageUrl,function(){$("#toper .company-name").text($.cookie(e.cookieKeyConf.companyName)),$("#toper .order-amount").text($.cookie(e.cookieKeyConf.orderAmount)),e.adjustBodyHeight(),e.resizePageBodyHeight(),e.switchLSide(),$('[data-toggle="tooltip"]').tooltip(),e.logout()})})}},this.adjustBodyHeight=function(){0!==$("#pageBody").size()&&$("#pageBody").height($(window).height()-50)},this.resizePageBodyHeight=function(){if(0!==$("#pageBody").size()){var i=this;$(window).resize(function(){i.adjustBodyHeight()})}},this.switchLSide=function(){if(0!==$("#lSide").size()&&0!==$("#lSideSwitcher").size()){var i=$("#lSide").width();i>0?$("#lSideSwitcher").addClass("on"):$("#lSideSwitcher").removeClass("on"),$("#lSideSwitcher").click(function(){var i=$(this).hasClass("on")?0:"220px";$("#lSide").animate({width:i},200),$("#dataPanel").animate({"margin-left":i},200),$(this).toggleClass("on")})}},this.addListenerToSearcher=function(){if(0!==$("#lSide .searcher").size()){var i=$("#lSide .searcher input[name='keywords']");i.focus(function(){$("#lSide .searcher").css({"background-color":"#fff"}),$(this).css({color:"#444"})}).blur(function(){$("#lSide .searcher").css({"background-color":"#2e343c"}),$(this).css({color:"#ccc"})}),$("#lSide .searcher .clear-keywords").click(function(){i.val("")})}},this.switchBranch=function(){0!==$("#lSide").size()&&$("#lSide dl dt").click(function(){$(this).siblings("dd").toggle("normal"),$(this).find(".switcher").toggleClass("icon-xiangxia2").toggleClass("icon-xiangshang3")})},this.bindLocationToLSide=function(i){$("#lSide dl dd ul li a").each(function(){var e=$(this).attr("data-name");"undefined"!==e&&e===i&&$(this).addClass("on")})},this.switchTabs=function(){require([this.utilStaticPrefix+"/jquery.tabs.min.js"],function(){$(".tabs").tabs({effect:"slideDown",duration:500})})},this.logout=function(){if(0!==$("#logoutBtn").size()){var i=this;$("#logoutBtn").click(function(){i.request(i.logoutApiUrl,{accountid:$.cookie(i.cookieKeyConf.userName)},{process:i.clearCookieRedirect()})})}},this.clearCookieRedirect=function(){for(key in this.cookieKeyConf)this.cookieKeyConf.hasOwnProperty(key)&&$.cookie(this.cookieKeyConf[key],null,{path:"/",domain:this.cookieDomain});window.location.href=this.logoutRedirectUrl},this.onload=function(){this.methodizeTable(),this.switchTabs()},this.onload()}