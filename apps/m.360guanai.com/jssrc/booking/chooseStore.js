/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1. 项目名称：m.360guanai.com
 2. 页面名称：ChooseDate(选择预约日期)
 3. 作者：尹芹(yinqin@guanaihui.com)
 4. 备注：
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
function ChooseStoreController() {
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    继承于Controller基类
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    Controller.call(this);
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    地区过滤条件的事件处理
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.switchDistrictSelectPanel();
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    筛选门店
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.searchStore();
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    选择门店
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.selectedStore();
};
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
日历月份切换
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
ChooseStoreController.prototype.switchDistrictSelectPanel = function() {
    require([
        this.appStaticPrefix + "/floatWindow.min.js"
    ], function() {
        var $floatWindow = $("#selectRegionWindow");
        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        加载城市地区页面
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
        $floatWindow.find(".float-window-body").load($floatWindow.find(".float-window-body").attr("data-source"), function() {});
        /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
        首先实例化一个查看地区的浮动窗口
        -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
        var floatWindow = new FloatWindow({
            "popTrigger": $("#filter-panel .region"),
            "floatWindows": $floatWindow
        });
    });
};
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
筛选门店
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
ChooseStoreController.prototype.searchStore = function() {
    if ($("#searchBtn").size === 0) return;
    $("#searchBtn").click(function() {
        $("#totalPanel").slideDown();
        $("#listContainer").slideDown();
        $("#dataLoadStatus").slideDown();
    })
};

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
用户选择门店之后效果
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
ChooseStoreController.prototype.selectedStore = function() {
    if($("#listContainer dl").size === 0) return ;
    $("#listContainer dl").click(function(){
        var _this = $(this);
        _this.addClass("active").siblings("dl").removeClass("active");
    })
};

/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
类的实例化
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
$(document).ready(function() {
    new ChooseStoreController;
});
