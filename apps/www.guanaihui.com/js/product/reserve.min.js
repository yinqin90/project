function Reserve(){this.sendSmsApiUrl="/sendmsg",this.reserveApiUrl="/product/booking",Controller.call(this),this.init(),this.addListenerToStoreList(),this.sendSms(),this.submitForm()}Reserve.prototype.init=function(){var e=$("#datepicker").attr("data-date"),t=new Date(e).addMonths(2).toString("M/d/yyyy");$("#datepicker").datepicker({format:"mm/dd/yyyy",language:"zh-CN",startDate:e,endDate:t}),$("#datepicker").on("changeDate",function(){$("#hiddenDate").val($("#datepicker").datepicker("getFormattedDate"))})},Reserve.prototype.addListenerToStoreList=function(){$("#storeId").val($(".selected-label").attr("data-id")),$("#module-reserve .dropdown-menu li").click(function(){var e=$(this),t=e.attr("data-id"),a=$(e.find("a").html());$(".selected-label").attr("data-id",t).html(" ").append(a),$("#storeId").val($(".selected-label").attr("data-id"))})},Reserve.prototype.sendSms=function(){var e=this;$("form").validationEngine({promptPosition:"topLeft",autoHidePrompt:!0,autoHideDelay:5e3,showOneMessage:!0,maxErrorsPerField:1}),$("form #btnSendSms").on("click",function(){$("#vertifyCode").removeAttr("data-validation-engine"),$("#vertifyCode").removeAttr("data-errormessage-value-missing");var t=60,a=$(this),i=$("form input[name='phone']"),r=$("form").validationEngine("validate");if(!r)return!1;if(a.hasClass(".disabled"))return!1;var n={mobile:$.trim(i.val()),smsType:0},o={apiDataType:"JSON",process:function(){a.addClass("disabled");var i=window.setInterval(function(){t-=1,e.html("重新发送("+t+"s)"),0===t&&(a.html("发送验证码"),a.removeClass("disabled"),window.clearInterval(i))},1e3)},onExceptionInterface:function(){}};e.request(e.sendSmsApiUrl,n,o)})},Reserve.prototype.submitForm=function(){if(0===$("#btnReserve").size())return 0;var e=this;$(".add").click(function(){var e=parseInt($("input[name='pnum']").val());99>=e?$("input[name='pnum']").val(e+1):" "}),$(".min").click(function(){var e=parseInt($("input[name='pnum']").val());e>1?$("input[name='pnum']").val(e-1):" "}),$("#btnReserve").click(function(){$(this);void 0==$("#vertifyCode").attr("data-validation-engine")&&($("#vertifyCode").attr("data-validation-engine","validate[required]"),$("#vertifyCode").attr("data-errormessage-value-missing","请输入验证码")),$("form").validationEngine({promptPosition:"topLeft",autoHidePrompt:!0,autoHideDelay:5e3,showOneMessage:!0,maxErrorsPerField:1});var t=$("form").validationEngine("validate");if(!t)return!1;var a={date:$.trim($("#hiddenDate").val()),storeId:$.trim($("#storeId").val()),phone:$.trim($("input[name='phone']").val()),vertifyCode:$.trim($("#vertifyCode").val()),pnum:$.trim($("input[name='pnum']").val()),productId:$.trim($("#productId").val())},i={apiDataType:"JSON",process:function(){window.location.href="/"},onExceptionInterface:function(){console.log("error")}};e.request(e.reserveApiUrl,a,i)})};