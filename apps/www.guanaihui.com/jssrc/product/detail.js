/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 1. 项目名称：www.guanaihui.com
 2. 页面名称：productDetail(产品详情)
 3. 作者：尹芹(yinqin@guanaihui.com)
 4. 备注：
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
function DetailController() {
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
     继承于Controller基类
     -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    Controller.call(this);
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    页面顶部全部服务分类下拉
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.servicesCategory();
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    显示更多
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.showMore();
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    显示产品fixed
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.showProduct();
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
    预约module框
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
    this.showReserveModual();

};


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 显示更多
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
DetailController.prototype.showMore = function() {
        if ($("#showMore").size() === 0) return;
        $("#showMore").click(function() {
            var _this = $(this);
            //_this.siblings(".more-item").slideToggle();
            _this.find("i").hasClass("icon-xiangxia2") ? _this.html("收起<i class='iconfont icon-xiangshang3'></i>") : _this.html("更多机构门店 <i class='iconfont icon-xiangxia2'></i>");
            _this.find("i").hasClass("icon-xiangxia2") ? _this.siblings(".more-item").slideUp() : _this.siblings(".more-item").slideDown();

        });
    }
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
     显示产品fixed
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
DetailController.prototype.showProduct = function() {
        $(window).scroll(function() {
            var $_suitStore = $(".suit-store").offset().top - 30,
                $_windowScroll = $(window).scrollTop();
            $_windowScroll >= $_suitStore ? $(".product-fixed").show() : $(".product-fixed").hide();
        });
    }
    /*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
     时间选择
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
DetailController.prototype.showReserveModual = function() {
    var _this = this;
    debugger
    require([
        _this.utilStaticPrefix + '/validation/js/languages/jquery.validationEngine-zh_CN.js',
        _this.utilStaticPrefix + '/validation/js/jquery.validationEngine.js',
        _this.utilStaticPrefix + '/Datejs/build/date.min.js',
        _this.appStaticPrefix + '/product/reserve.min.js'
    ], function() {
        $(".btn-reserve").click(function() {
            _this.dialog({
                "tabindex": 1,
                "id": "module-reserve",
                "effect": false,
                "url": $(this).attr("data-href")
            });
            $('#module-reserve').on('loaded.bs.modal', function(e) {
                new Reserve();
            });
        });
    });
};
/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------------
 类的初始化
 -----------------------------------------------------------------------------------------------------------------------------------------------------------------------*/
$(document).ready(function() {
    new DetailController;
});
